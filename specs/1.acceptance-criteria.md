# Acceptance Criteria for aki-mline (EARS Format)

This document provides the acceptance criteria for the `aki-mline` utility, written in the EARS (Easy Approach to Requirements Syntax).

### System-Wide Behavior (Ubiquitous)

- **AC-U1:** The `aki-mline` shall write processed output to standard output.
- **AC-U2:** The `aki-mline` shall write error messages to standard error.

### Event-Driven Features

- **AC-ED1:** When receiving text on standard input, the `aki-mline` shall read it line-by-line.
- **AC-ED2:** When the user provides the `-H` or `--help` flag, the `aki-mline` shall display a help message and exit.
- **AC-ED3:** When the user provides the `-V` or `--version` flag, the `aki-mline` shall display version information and exit.

### Optional Features (Where)

- **AC-W1:** Where the user provides a regex pattern via `-e` or `--exp`, the `aki-mline` shall filter input based on that pattern.
- **AC-W2:** Where the user provides a string pattern via `-s` or `--str`, the `aki-mline` shall filter input based on that pattern.
- **AC-W3:** Where the user provides the `-i` or `--inverse` flag, the `aki-mline` shall output lines that do *not* match the given patterns.
- **AC-W4:** Where the user provides the `--color` option with `always`, the `aki-mline` shall highlight matching substrings.
- **AC-W5:** Where the user provides the `--color` option with `never`, the `aki-mline` shall not highlight matching substrings.
- **AC-W6:** Where the `AKI_MLINE_COLOR_SEQ_ST` and `AKI_MLINE_COLOR_SEQ_ED` environment variables are set, the `aki-mline` shall use their values for color highlighting.
- **AC-W7:** Where the user provides an `-X` option, the `aki-mline` shall process the corresponding special system-level request.

### State-Driven Features (While)

- **AC-ST1:** While the standard output is a TTY and the `--color` option is set to `auto`, the `aki-mline` shall highlight matching substrings.
- **AC-ST2:** While the standard output is not a TTY and the `--color` option is set to `auto`, the `aki-mline` shall not highlight matching substrings.
- **AC-ST3:** While the output pipe is closed by the receiving process, the `aki-mline` shall exit gracefully without a broken pipe error.

### Unwanted Behavior (If/Then)

- **AC-IF1:** If no pattern (`-e` or `-s`) is provided by the user, then the `aki-mline` shall report an error and exit.
- **AC-IF2:** If the user provides an unrecognized command-line argument, then the `aki-mline` shall report an error and exit.
